From: "Richard W.M. Jones" <rjones@redhat.com>
Date: Thu, 4 Mar 2021 11:57:44 +0000
Subject: customize, resize, sparsify, sysprep: Link explicitly with pthread

Cherry picked from guestfs-tools commit 87543dad61.
---
 customize/Makefile.am | 1 +
 resize/Makefile.am    | 1 +
 sparsify/Makefile.am  | 1 +
 sysprep/Makefile.am   | 1 +
 4 files changed, 4 insertions(+)

diff --git a/customize/Makefile.am b/customize/Makefile.am
index c926687..fb418d7 100644
--- a/customize/Makefile.am
+++ b/customize/Makefile.am
@@ -169,6 +169,7 @@ OCAMLLINKFLAGS = \
 	$(LINK_CUSTOM_OCAMLC_ONLY)
 
 OCAMLCLIBS = \
+	-pthread -lpthread \
 	-lutils \
 	$(LIBTINFO_LIBS) \
 	$(LIBCRYPT_LIBS) \
diff --git a/resize/Makefile.am b/resize/Makefile.am
index fa88cc6..936d2b0 100644
--- a/resize/Makefile.am
+++ b/resize/Makefile.am
@@ -72,6 +72,7 @@ OCAMLPACKAGES += -package gettext-stub
 endif
 
 OCAMLCLIBS = \
+	-pthread -lpthread \
 	-lprogress \
 	-lutils \
 	$(LIBTINFO_LIBS) \
diff --git a/sparsify/Makefile.am b/sparsify/Makefile.am
index fa964e8..4d1af85 100644
--- a/sparsify/Makefile.am
+++ b/sparsify/Makefile.am
@@ -80,6 +80,7 @@ OCAMLPACKAGES += -package gettext-stub
 endif
 
 OCAMLCLIBS = \
+	-pthread -lpthread \
 	-lprogress \
 	-lutils \
 	$(LIBTINFO_LIBS) \
diff --git a/sysprep/Makefile.am b/sysprep/Makefile.am
index 69bb928..250c749 100644
--- a/sysprep/Makefile.am
+++ b/sysprep/Makefile.am
@@ -129,6 +129,7 @@ OCAMLPACKAGES += -package gettext-stub
 endif
 
 OCAMLCLIBS = \
+	-pthread -lpthread \
 	-lvisit \
 	-lstructs \
 	-lutils \
